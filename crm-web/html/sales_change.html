<!DOCTYPE html>
<html>


<!-- Mirrored from www.zi-han.net/theme/hplus/table_bootstrap.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:03 GMT -->
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>销售机会管理</title>

    <link rel="shortcut icon" href="favicon.ico">
	<link href="css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">
    <link href="css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link href="css/animate.min.css" rel="stylesheet">
    <link href="css/style.min862f.css?v=4.1.0" rel="stylesheet">
    <link href="css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
	<script src="js/plugins/sweetalert/sweetalert.min.js"></script>

</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
        <!-- Panel Other -->
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>销售机会管理</h5>
                <div class="ibox-tools">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-wrench"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a href="#">选项1</a>
                        </li>
                        <li><a href="#">选项2</a>
                        </li>
                    </ul>
                    <a class="close-link">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
            </div>
            <div class="ibox-content">
                <div class="row row-lg">
                    

                    <div class="col-sm-12">
                        <!-- Example Events -->
                        <div class="example-wrap">
                            <div class="example">
								<div class="pull-left" style="margin-bottom:12px;">
									<form class="form-inline" role="form" id="search-form">
									  <div class="form-group">
										<label>客户名称</label>
										<input type="email" name="custName" class="form-control input-sm" placeholder="客户名称">
                                          <input type="hidden" name="createId">
									  </div>
									  <div class="form-group" style="margin-left:10px">
										<label>概要</label>
										<input type="text" name="title" class="form-control input-sm" placeholder="概要">
									  </div>
									  <div class="form-group" style="margin-left:10px">
										<label>联系人</label>
										<input type="text" name="linkman" class="form-control input-sm" placeholder="联系人">
                                          <input type="hidden" name="status" value="server_create">
									  </div>
									</form>
								</div>
								<div class="btn-group hidden-xs pull-right" id="exampleTableEventsToolbar" role="group">
									<button type="submit" class="btn btn-outline btn-default" id="search-but">
										<i class="glyphicon glyphicon-search" aria-hidden="true"></i>
										搜索
									</button>
									<button type="button" class="btn btn-outline btn-default" data-toggle="modal" data-target="#myModal2">
										<i class="glyphicon glyphicon-plus" aria-hidden="true"></i>
										新建
									</button>
								</div>
                                <table class="table table-bordered table-hover" 
								       data-height="40c0"
									   style="margin-bottom:0px"
									   data-mobile-responsive="true">
                                    <thead>
                                        <tr>
                                            <th>编号</th>
                                            <th>客户名称</th>
                                            <th>概要</th>
											<th>联系人</th>
											<th>联系人电话</th>
											<th>创建时间</th>
											<th>
												<div align="center">操作</div>
											</th>
                                        </tr>
                                    </thead>
									<tbody id="dataRow">

									</tbody>
                                </table>
								<div class="row">
									<div class="col-lg-6">
										<div class="pull-left" style="margin-top:15px">
											<p>显示 1 到 5 项，共 <lable id="pageSize">25</lable> 项</p>
										</div>
									</div>
									<div class="col-lg-6">
										<div class="pull-right">
											<ul class="pagination">
                                                <li class="prev"><a>«</a></li>
                                                <li  class="next"><a>»</a></li>
											</ul>
										</div>
									</div>
								</div>
								
                            </div>
                        </div>
                        <!-- End Example Events -->
                    </div>
                </div>
            </div>
        </div>
        <!-- End Panel Other -->
    </div>
	
	<!-- ****************************添加销售机会框**************************** -->
	<div class="modal inmodal" id="myModal2" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog" style="width:800px;margin-top:20px;">
			<div class="modal-content animated flipInY">
                <form id="addForm">
                    <div class="modal-header" style="height:50px;padding-top:15px;">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
                        <div class="pull-left"><h4>新建销售机会</h4></div>
                    </div>
                    <div class="modal-body" style="background-color:#fff;padding-bottom:0px;padding-top:10px;">
                        <table class="table table-bordered">
                            <tr>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">编号</span>
                                </th>
                                <td width="35%">
                                    <input type="email" name="id" class="form-control input-sm" disabled placeholder="由系统生成">
                                </td>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">机会来源</span>
                                </th>
                                <td width="35%">
                                    <select name="source" class="form-control input-sm source" style="height: 35px">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">客户名称</span>
                                </th>
                                <td>
                                    <input type="text" name="custName" class="form-control input-sm" placeholder="客户名称">
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">成功几率</span>
                                </th>
                                <td><input type="text" name="rate" class="form-control input-sm" placeholder="成功几率"></td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">概要</span>
                                </th>
                                <td>
                                    <input type="text" name="title" class="form-control input-sm" placeholder="概要">
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">机会描述</span>
                                </th>
                                <td>
                                    <textarea class="form-control input-sm" name="desc" rows="2">这是一个机会描述</textarea>
                                </td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">联系人</span>
                                </th>
                                <td>
                                    <input type="text" name="linkman" class="form-control input-sm" placeholder="联系人">
                                </td>
                                <th  style="background-color:#F5F5F6">
                                    <span style="color:#000">联系人电话</span>
                                </th>
                                <td><input type="text" name="tel" class="form-control input-sm" placeholder="联系人电话"></td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">创建人</span>
                                </th>
                                <td>
                                    <input type="text" disabled name="createName" class="form-control input-sm" placeholder="创建人">
                                    <input type="hidden"  name="createName" >
                                    <input type="hidden" name="createId">
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">创建时间</span>
                                </th>
                                <td><input disabled type="text" name="createDate" class="form-control input-sm" placeholder="创建时间"></td>
                            </tr>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                        <button id="add-btn" type="button" class="btn btn-primary">保存</button>
                    </div>
                </form>
			</div>
		</div>
	</div>
	<!-- ****************************添加销售机会框结束**************************** -->
	
	<!-- ****************************分配销售机会框**************************** -->
	<div class="modal inmodal" id="myModal3" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog" style="width:800px;margin-top:20px;">
			<div class="modal-content animated flipInY">
                    <div class="modal-header" style="height:50px;padding-top:15px;">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
                        <div class="pull-left"><h4>分配销售机会</h4></div>
                    </div>
                    <div class="modal-body" style="background-color:#fff;padding-bottom:0px;padding-top:10px;">
                        <form id="aForm">
                            <table class="table table-bordered">
                            <tr>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">编号</span>
                                </th>
                                <td width="35%">
                                    <input type="email" name="id" class="form-control input-sm" disabled >
                                    <input type="hidden" name="id">
                                </td>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">机会来源</span>
                                </th>
                                <td width="35%">
                                    <select disabled="" name="source" class="form-control input-sm source" style="height: 35px">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">客户名称</span>
                                </th>
                                <td>
                                    <input type="email" name="custName" class="form-control input-sm" disabled >
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">成功几率</span>
                                </th>
                                <td><input type="email" name="rate" class="form-control input-sm" disabled ></td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">概要</span>
                                </th>
                                <td>
                                    <input type="email" name="title" class="form-control input-sm" disabled >
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">机会描述</span>
                                </th>
                                <td>
                                    <textarea class="form-control input-sm" name="desc"  rows="2" disabled></textarea>
                                </td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">联系人</span>
                                </th>
                                <td>
                                    <input type="email" name="linkman" class="form-control input-sm" disabled >
                                </td>
                                <th  style="background-color:#F5F5F6">
                                    <span style="color:#000">联系人电话</span>
                                </th>
                                <td><input type="email" name="tel" class="form-control input-sm" disabled ></td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">创建人</span>
                                </th>
                                <td>
                                    <input type="email" name="createName" class="form-control input-sm" disabled >
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">创建时间</span>
                                </th>
                                <td><input type="email" name="createDate" class="form-control input-sm" disabled ></td>
                            </tr>
                        </table>
                        </form>
                        <form id="allot-form">
                         <table class="table table-bordered">
                            <tr>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">指派给</span>
                                    <input type="hidden" name="id">
                                </th>
                                <td  width="35%">
                                    <select style="height: 35px" class="form-control input-sm" name="dueId" >
                                    </select>
                                </td>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">指派时间</span>
                                </th>
                                <td  width="35%">
                                    <input type="email" disabled  name="dueDate"  class="form-control input-sm" placeholder="">
                                </td>
                            </tr>
                        </table>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                        <button type="submit" id="allot-btn" class="btn btn-primary">保存</button>
                    </div>
			</div>
		</div>
	</div>
	<!-- ****************************分配销售机会框结束**************************** -->
	
	<!-- ****************************修改销售机会框**************************** -->
	<div class="modal inmodal" id="myModal4" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog" style="width:800px;margin-top:20px;">
			<div class="modal-content animated flipInY">
                <form id="updForm">
                    <div class="modal-header" style="height:50px;padding-top:15px;">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
                        <div class="pull-left"><h4>修改销售机会</h4></div>
                    </div>
                    <div class="modal-body" style="background-color:#fff;padding-bottom:0px;padding-top:10px;">
                        <table class="table table-bordered">
                            <tr>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">编号</span>
                                </th>
                                <td width="35%">
                                    <input type="text" name="id" class="form-control input-sm" disabled >
                                    <input type="hidden" name="id">
                                </td>
                                <th style="background-color:#F5F5F6" width="15%">
                                    <span style="color:#000">机会来源</span>
                                </th>
                                <td width="35%">
                                    <select name="source" class="form-control input-sm source" style="height: 35px">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">客户名称</span>
                                </th>
                                <td>
                                    <input type="text"  name="custName" class="form-control input-sm" >
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">成功几率</span>
                                </th>
                                <td><input type="text" name="rate" class="form-control input-sm" ></td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">概要</span>
                                </th>
                                <td>
                                    <input type="text" name="title" class="form-control input-sm" placeholder="">
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">机会描述</span>
                                </th>
                                <td>
                                    <textarea class="form-control input-sm" name="desc" rows="2"></textarea>
                                </td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">联系人</span>
                                </th>
                                <td>
                                    <input type="text" name="linkman" class="form-control input-sm"  >
                                </td>
                                <th  style="background-color:#F5F5F6">
                                    <span style="color:#000">联系人电话</span>
                                </th>
                                <td><input type="text" name="tel" class="form-control input-sm" ></td>
                            </tr>
                            <tr>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">创建人</span>
                                </th>
                                <td>
                                    <input type="text" class="form-control input-sm" name="createName" disabled >
                                </td>
                                <th style="background-color:#F5F5F6">
                                    <span style="color:#000">创建时间</span>
                                </th>
                                <td><input type="text" class="form-control input-sm" name="createDate" disabled ></td>
                            </tr>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                        <button type="submit" class="btn btn-primary" >保存</button>
                    </div>
                </form>
			</div>
		</div>
	</div>
	<!-- ****************************修改销售机会框结束**************************** -->
	
    <script src="js/jquery.min.js?v=2.1.4"></script>
    <script src="js/bootstrap.min.js?v=3.3.6"></script>
    <script src="js/content.min.js?v=1.0.0"></script>
    <script src="js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
    <script src="js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="js/demo/bootstrap-table-demo.min.js"></script>
    <script src="js/utils.js"></script>
	<script>
        $("#search-form input[name='createId']").val(getUserId());
        page(1)
        $("#search-but").click(function () {
            page(1)
            return false;
        });

		// page(1)
        function page(pageIndex)  {
            if (isNaN(pageIndex)){
                return false;
            }
            var str = $("#search-form").serializeArray();
            var condition = JSON.stringify(formToJson(str));
            var pageSize = 10;
            var pageParam = {
                "pageIndex":pageIndex,
                "pageSize":pageSize,
                "condition":condition
            };
            console.log(pageParam);
            $.ajax({
                url:"/marker/all",
                type:"GET",
                headers:{'Authorization':''+getToken()+''},
                data:pageParam,
                success:function (result) {
                    var data = result.data;
                    //---------------------渲染数据
                    var tableData = "";
                    $.each(data.records,function (i,v) {
                        tableData += `
                        <tr>
                                            <td>${i+1}</td>
											<td>${v.custName}</td>
											<td style="width: 450px">${v.title}</td>
											<td>${v.linkman}</td>
											<td>${v.tel}</td>
											<td>${new Date(v.createDate).Format("yyyy年MM月dd日")}</td>

											<td align="center">
												<div>
													<a title="指派" data-toggle="modal" data-target="#myModal3">
														<i data-id="${v.id}" class="glyphicon glyphicon-log-in" aria-hidden="true"></i>
													</a>
													&nbsp;&nbsp;
													<a title="修改" data-toggle="modal" data-target="#myModal4" style="color:#CC6600">
														<i data-id="${v.id}" class="glyphicon glyphicon-pencil" aria-hidden="true"></i>
													</a>
													&nbsp;&nbsp;
													<a onclick="isDel();" title="删除" style="color:#CC0000">
														<i data-id="${v.id}" class="glyphicon glyphicon-remove" aria-hidden="true"></i>
													</a>
												</div>
											</td>
										</tr>
                    `;

                    });
                    $("#dataRow").empty();
                    $(tableData).appendTo($("#dataRow"))

                    //---------------------渲染分页按钮
                    var dataCount = data.total;
                    var pageSize = data.pageSize
                    var len = 0;
                    if ((dataCount%pageSize)==0){
                        len = parseInt(dataCount/pageSize);
                    }else {
                        len =parseInt((dataCount/pageSize)+1)
                    }
                    //拼接的字符串
                    var strData = "";
                    if (Number(pageIndex)+2<=len && pageIndex-2>=1){
                        strData += `
                        <li class="page"><a>${pageIndex-2}</a></li>
                        <li class="page"><a>${pageIndex-1}</a></li>
                        <li class="active page"><a>${pageIndex}</a></li>
                        <li class="page"><a>${Number(pageIndex)+Number(1)}</a></li>
                        <li class="page"><a>${Number(pageIndex)+Number(2)}</a></li>

                    `;
                    }else {
                        var i = pageIndex;
                        if (Number(i)+5>len){
                            i=len-4;
                        }
                        if (len-5<=1){
                            i=1;
                        }
                        for (;i<Number(pageIndex)+5 & i<=len;i++){
                            if (i==data.pageIndex){
                                strData+= `
                         <li class="active page"><a>${i}</a></li>
                    `
                            }else {
                                strData+= `
                         <li class="page"><a>${i}</a></li>
                    `
                            }
                        }
                    }
                    $(".page").remove();
                    $(".prev").after(strData);
                    $("#pageSize").text(data.total);
                    $(".next").removeClass("disabled");
                    $(".prev").removeClass("disabled");
                    if (pageIndex==1){
                        $(".prev").addClass("disabled");
                    }
                    if (pageIndex==len){
                        $(".next").addClass("disabled");
                    }
                }
            });
        }

        //-------------页码点击事件
        $(".pagination").on("click",".page a",function (event) {
            var pageIndex1 = $(".active").text();
            var pageIndex = $(this).text();
            if (pageIndex1!=pageIndex){
                page(pageIndex);
            }
        });

        //-------------上一页点击
        $(".prev").click(function () {
            var pageIndex = $(".active").text();
            page(pageIndex-1)
        });

        //-------------下一页点击
        $(".next").click(function () {
            var pageIndex = $(".active").text();
            page(Number(pageIndex)+1)
        });

        //-------------分配销售机会
        $("#dataRow").on("click",".glyphicon-log-in",function () {
            var  markerId= $(this).attr("data-id");
            var staff = getUSerByRoleId(4);
            $(staff).appendTo($("#allot-form select[name='dueId']"));
            $.ajax({
                url:"/marker/list/"+markerId+"",
                type:"GET",
                headers:{'Authorization':''+getToken()+''},
                success:function (result) {
                    if(result.data!= "null"){
                        var marker = result.data;
                        $("#aForm input[name='id']").val(marker.id);
                        $("#allot-form input[name='id']").val(marker.id);
                        $("#aForm input[name='custName']").val(marker.custName);
                        $("#aForm input[name='rate']").val(marker.rate);
                        $("#aForm input[name='title']").val(marker.title);
                        $("#aForm textarea[name='desc']").text(marker.desc);
                        $("#aForm input[name='linkman']").val(marker.linkman);
                        $("#aForm input[name='tel']").val(marker.tel);
                        $("#aForm input[name='createName']").val(marker.createName);
                        $("#aForm input[name='createDate']").val( new Date(marker.createDate).Format("yyyy年MM月dd日"));
                        $("#aForm select[name='source']").val(marker.source);
                    }
                }
            });

        });
        
        //-------------分配销售机会 保存按钮
        $("#allot-btn").click(function () {
            var ary = $("#allot-form").serializeArray();
            var params = formToJson(ary);
            var dueName = $("#allot-form select[name='dueId']").find("option:selected").text();
            params.dueName = dueName

            $.ajax({
                type:"POST",
                url:"/marker/allot",
                headers:{'Authorization':''+getToken()+''},
                data:params,
                success:function (result) {
                    if (result.data){
                        swal("保存成功！","",
                            "success"
                        )
                        $("#updForm textarea").val("");
                        $("#updForm input[type='text']").val("");
                        $(".modal-backdrop").hide();
                        $("#myModal3").removeClass("in").hide()

                    }
                }
            });
        });
        
        
        //-------------修改按钮
        $("#dataRow").on("click",".glyphicon-pencil",function () {

            var  markerId= $(this).attr("data-id");

            $.ajax({
                url:"/marker/list/"+markerId+"",
                type:"GET",
                async:false,
                headers:{'Authorization':''+getToken()+''},
                success:function (result) {
                    if(result.data!= "null"){
                        var marker = result.data;
                        $("#updForm input[name='id']").val(marker.id);
                        $("#updForm input[name='custName']").val(marker.custName);
                        $("#updForm input[name='rate']").val(marker.rate);
                        $("#updForm input[name='title']").val(marker.title);
                        $("#updForm textarea[name='desc']").text(marker.desc);
                        $("#updForm input[name='linkman']").val(marker.linkman);
                        $("#updForm input[name='tel']").val(marker.tel);
                        $("#updForm input[name='createName']").val(marker.createName);
                        $("#updForm input[name='createDate']").val( new Date(marker.createDate).Format("yyyy年MM月dd日"));
                    }
                }
            });
        });

        //-------------修改
        $("#updForm").submit(function(){
            var aryData = $("#updForm").serializeArray();
            var data = formToJson(aryData);

            // console.log(JSON.parse(data));
            $.ajax({
                type:"put",
                url:"/marker/update",
                headers:{'Authorization':''+getToken()+''},
                contentType:"application/json",
                dataType:"json",
                data:JSON.stringify(data),
                success:function (result) {
                    if (result.data){
                        swal("分配成功！","",
                            "success"
                        )
                        $("#updForm textarea").val("");
                        $("#updForm input[type='text']").val("");
                        $(".modal-backdrop").hide();
                        $("#myModal3").removeClass("in").hide()
                        page(1);
                    }
                }
            });
            return false;
        });

        //-------------添加
        $("#add-btn").click(function(){
            var aryData = $("#addForm").serializeArray();
            console.log(aryData);
            var data = formToJson(aryData);

            $.ajax({
                url:"/marker/add",
                type:"POST",
                async:false,
                data:data,
                headers:{'Authorization':''+getToken()+''},
                success:function (result) {
                    if (result.data){
                        swal("添加成功！","",
                            "success"
                        )
                        $("#myModal input[type=text]").val("")
                        $(".modal-backdrop").hide();
                        $("#myModal2").removeClass("in").hide()
                        page(1);
                    }
                }
            });
            return false;
        });

        //-------------删除
        $("#dataRow").on("click",".glyphicon-remove",function () {
            var param = $(this).attr("data-id");
            swal({
                    title:"您确定要删除这条信息吗",
                    text:"删除后将无法恢复，请谨慎操作！",
                    type:"warning",
                    showCancelButton:true,
                    confirmButtonColor:"#DD6B55",
                    confirmButtonText:"确定",
                    cancelButtonText:"取消",
                    closeOnConfirm:false,
                    closeOnCancel:false},
                function(isConfirm){
                    if(isConfirm){
                        console.log(111111);
                        console.log(param);
                        $.ajax({
                            type:"delete",
                            url:"/marker/delet/"+param+"",
                            headers:{'Authorization':''+getToken()+''},
                            success:function (result) {
                                console.log(result);
                                if (result.data){
                                    swal("删除成功！","您已经永久删除了这条信息。",
                                        "success",
                                    )
                                    page(1)
                                }else {
                                    swal("删除失败！",result.msg,
                                        "warning",
                                    )
                                    return true;
                                }
                            }
                        });


                    }else{
                        swal("已取消",
                            "您取消了删除操作！","error"
                        )
                    }
                }
            )
            var userId = $(this).attr("data-id");
        });

        //-------------渲染机会来源下拉框
        $.get("/dic/chance_type",function (res) {
            var data = "";
            $.each(res.data, function (i, v) {
                data += `
                            <option value="${v.valueId}">${v.valueName}</option>
                        `
            });
            $(data).appendTo($(".source"));
        })

        var token = getToken();
        var payload = parsePayload(token);
        console.log(payload);
        $("#addForm input[name='createId']").val(payload.userId)
        $("#addForm input[name='createName']").val(payload.userName)

	</script>
</body>


<!-- Mirrored from www.zi-han.net/theme/hplus/table_bootstrap.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:06 GMT -->
</html>
